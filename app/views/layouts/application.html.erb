<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= content_for(:title) || "Haruchat5" %></title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= yield :head %>

  <link rel="icon" href="/icon.png" type="image/png">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/icon.png">

  <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>

<body>
  <aside>
  <header class="logo">
    <h1>HaruChatX</h1>
  </header>

<nav aria-label="Chats list">
  <ul>
    <li>
      <%= button_to "➕ Start new chat",
                    conversations_path,
                    method: :post,
                    class: "new-chat-btn" %>
    </li>

    <% Current.user.conversations.order(created_at: :desc).each do |conversation| %>
      <% active = (defined?(@conversation) && @conversation&.id == conversation.id) %>
      <li id="<%= dom_id(conversation, :row) %>" data-conversation-id="<%= conversation.id %>">
        <%= link_to conversation_path(conversation),
                    aria: { current: (active ? "page" : nil) } do %>
          <span class="chat-title"><%= conversation.title.presence || "Untitled chat" %></span>
          <span class="delete"
                data-delete-url="<%= conversation_path(conversation) %>"
                aria-label="Usuń konwersację"
                title="Usuń"
                role="button"
                tabindex="0">×</span>
        <% end %>
      </li>
    <% end %>
  </ul>
</nav>



</aside>
<%= yield %>
</body>
</html>
